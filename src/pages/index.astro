---
// Dosya Yolu: src/pages/index.astro
import Layout from '../layouts/Layout.astro';
import TurCard from '../components/TurCard.astro';
import HeroSlider from '../components/HeroSlider.astro';
import sanityClient from '../lib/sanityClient';
import type { SanityDocument } from '@sanity/client';

const query = `{
  "turlar": *[_type == "tur"],
  "ayarlar": *[_type == "siteAyarlari"][0]
}`;
const data = await sanityClient.fetch(query);
const turlar: SanityDocument[] = data.turlar || [];
const ayarlar: SanityDocument = data.ayarlar || {};
---

<Layout title="Sea Love Tisan - Ana Sayfa">
  
  <HeroSlider />

  <section id="hakkimizda" class="py-20 bg-white">
    <div class="container mx-auto px-6 max-w-4xl text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-cyan-800 mb-6">Deniz Tutkunlarının Buluşma Noktası</h2>
      <p class="text-lg text-gray-700 leading-relaxed">
        Yılların verdiği tecrübe ve denize olan sonsuz aşkımızla, sizlere sadece bir tekne turu değil, unutulmaz anılarla dolu bir gün vaat ediyoruz. Tisan'ın el değmemiş koylarında, masmavi suların üzerinde, Akdeniz güneşinin tadını çıkarırken kendinizi özel hissedeceksiniz. Güvenli ve konforlu teknemiz, güler yüzlü ekibimiz ve size özel hazırladığımız ikramlarımızla, her detayı sizin için düşündük. Gelin, bu eşsiz deneyimi Sea Love Tisan farkıyla birlikte yaşayalım.
      </p>
    </div>
  </section>

  <!-- 3. BÖLÜM: Turlar (DÜZELTİLMİŞ FLEXBOX YAPISI) -->
  <section id="turlar" class="py-20 bg-gray-50">
    <div class="container mx-auto px-6 max-w-7xl">
      <h2 class="text-3xl md:text-4xl font-bold text-center text-cyan-800 mb-12">Popüler Turlarımız</h2>
      <div class="flex flex-wrap justify-center -mx-4">
        {turlar.map(tur => (
          <div class="w-full sm:w-1/2 lg:w-1/3 p-4">
            <TurCard tur={tur} />
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- 4. BÖLÜM: İLETİŞİM (LOGOSUZ VE WHATSAPP İKONLU) -->
<section id="iletisim" class="py-20 bg-gray-50">
  <div class="container mx-auto px-6">

    <!-- Ana Konteyner Kartı -->
    <div class="relative bg-gradient-to-r from-cyan-800 to-blue-900 text-white rounded-2xl shadow-xl p-8 md:p-12 overflow-hidden">
      
      <!-- Arka Plan Desen -->
      <div class="absolute inset-0 opacity-10" style="background-image: url('/wave-pattern.svg'); background-size: cover; background-position: center;"></div>

      <!-- İçerik -->
      <div class="relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        
        <!-- Sol Taraf: Metin ve İletişim Bilgileri -->
        <div class="text-center lg:text-left">
          <h2 class="text-3xl lg:text-4xl font-bold mb-4">Detaylı Bilgi ve Rezervasyon</h2>
          <p class="text-lg text-white/80 max-w-lg mx-auto lg:mx-0">
            Unutulmaz bir deniz macerasına atılmak veya turlarımız hakkında daha fazla bilgi edinmek için bizimle iletişime geçin. Profesyonel ekibimiz, tüm sorularınızı yanıtlamaktan memnuniyet duyacaktır.
          </p>
          
          <!-- İletişim Detayları -->
          <div class="mt-8 space-y-4 inline-flex flex-col items-start">
            <div class="flex items-center gap-3">
              <!-- Telefon İkonu -->
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white/80 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg>
              <a href={`tel:${ayarlar.whatsappNumarasi || ''}`} class="text-xl font-semibold hover:underline">
                {ayarlar.telefonNumarasi || 'Telefon Girilmemiş'}
              </a>
            </div>
            <div class="flex items-center gap-3">
              <!-- YENİDEN EKLENEN WHATSAPP İKONU -->
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white/80 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.655 4.398 1.803 6.22l-1.072 3.912 3.912-1.072z"/></svg>
              <a href={`https://wa.me/${ayarlar.whatsappNumarasi}`} target="_blank" class="text-xl font-semibold hover:underline">
                WhatsApp'tan Yazın
              </a>
            </div>
          </div>
        </div>

        <!-- Sağ Taraf: Harita -->
        <div class="w-full h-80 md:h-96">
          {ayarlar.googleMapsLink ? (
            <div class="w-full h-full shadow-lg rounded-lg overflow-hidden">
                <iframe src={ayarlar.googleMapsLink} width="100%" height="100%" class="border-0" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
          ) : (
            <div class="flex items-center justify-center h-full bg-black/20 rounded-lg"><p>Harita konumu yakında eklenecektir.</p></div>
          )}
        </div>

      </div>
    </div>
  </div>
</section>

</Layout>